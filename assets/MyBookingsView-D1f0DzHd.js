import{f as $,u as A,r as f,h as F,c as _,w as t,i as k,a as e,o as a,b as o,d as i,l as u,F as y,q as G,k as W,t as g,m as q}from"./index-B8VNrrUr.js";const E={key:2,class:"text-center text-grey py-16"},J={__name:"MyBookingsView",setup(I){const r=$(),h=A(),{user:w}=h,l=f([]),d=f(!0);async function m(){d.value=!0;try{const{data:s}=await k.get(`/bookings?userId=${w.id}&_sort=dateTime&_order=asc`);l.value=s}catch{r.showSnackbar("讀取預約紀錄失敗","error")}finally{d.value=!1}}async function b(s){if(confirm("您確定要取消這個預約嗎？")){r.setGlobalLoading(!0);try{await k.delete(`/bookings/${s}`),r.showSnackbar("預約已取消","success"),await m()}catch{r.showSnackbar("取消失敗","error")}finally{r.setGlobalLoading(!1)}}}return F(m),(s,n)=>{const v=e("v-card-title"),x=e("v-skeleton-loader"),p=e("v-icon"),S=e("v-list-item-title"),B=e("v-list-item-subtitle"),T=e("v-btn"),C=e("v-list-item"),L=e("v-divider"),V=e("v-list"),D=e("v-card-text"),N=e("v-card"),z=e("v-container");return a(),_(z,null,{default:t(()=>[o(N,{rounded:"lg"},{default:t(()=>[o(v,null,{default:t(()=>n[0]||(n[0]=[i("我的預約紀錄",-1)])),_:1,__:[0]}),o(D,null,{default:t(()=>[d.value?(a(),_(x,{key:0,type:"table-row-divider@5"})):l.value.length>0?(a(),_(V,{key:1,lines:"two"},{default:t(()=>[(a(!0),u(y,null,G(l.value,(c,M)=>(a(),u(y,{key:c.id},[o(C,null,{prepend:t(()=>[o(p,{color:"primary"},{default:t(()=>n[1]||(n[1]=[i("mdi-calendar-check",-1)])),_:1,__:[1]})]),append:t(()=>[o(T,{color:"red",variant:"text",onClick:j=>b(c.id)},{default:t(()=>n[2]||(n[2]=[i("取消預約",-1)])),_:2,__:[2]},1032,["onClick"])]),default:t(()=>[o(S,{class:"font-weight-bold"},{default:t(()=>[i(g(new Date(c.dateTime).toLocaleDateString("zh-TW",{year:"numeric",month:"long",day:"numeric"})),1)]),_:2},1024),o(B,null,{default:t(()=>[i(" 時間："+g(new Date(c.dateTime).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"})),1)]),_:2},1024)]),_:2},1024),M<l.value.length-1?(a(),_(L,{key:0,inset:""})):W("",!0)],64))),128))]),_:1})):(a(),u("div",E,[o(p,{icon:"mdi-calendar-multiple-check",size:"64"}),n[3]||(n[3]=q("p",{class:"mt-4 text-h6"},"您目前沒有任何預約",-1))]))]),_:1})]),_:1})]),_:1})}}};export{J as default};
